"use strict";(self["webpackChunkk_style"]=self["webpackChunkk_style"]||[]).push([[100],{6778:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(6768),s=a(4232),r=a(5130);const d=e=>((0,l.Qi)("data-v-0a52d964"),e=e(),(0,l.jt)(),e),i={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},o=d((()=>(0,l.Lk)("span",{"aria-hidden":"true"},"«",-1))),u=[o],p=["onClick"],c=d((()=>(0,l.Lk)("span",{"aria-hidden":"true"},"»",-1))),k=[c];function h(e,t,a,d,o,c){return(0,l.uX)(),(0,l.CE)("nav",i,[(0,l.Lk)("ul",n,[(0,l.Lk)("li",{class:(0,s.C4)(["page-item",{disabled:1===a.pages.current_page}])},[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,r.D$)(((...e)=>c.previousPage&&c.previousPage(...e)),["prevent"]))},u)],2),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.pages.total_pages,(e=>((0,l.uX)(),(0,l.CE)("li",{class:(0,s.C4)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,l.Lk)("a",{class:"page-link",href:"#",onClick:(0,r.D$)((t=>c.updatePage(e)),["prevent"])},(0,s.v_)(e),9,p)],2)))),128)),(0,l.Lk)("li",{class:(0,s.C4)(["page-item",{disabled:a.pages.current_page===a.pages.total_pages}])},[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,r.D$)(((...e)=>c.nextPage&&c.nextPage(...e)),["prevent"]))},k)],2)])])}var L={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)},previousPage(){this.pages.current_page>1&&this.updatePage(this.pages.current_page-1)},nextPage(){this.pages.current_page<this.pages.total_pages&&this.updatePage(this.pages.current_page+1)}}},m=a(1241);const g=(0,m.A)(L,[["render",h],["__scopeId","data-v-0a52d964"]]);var b=g},4652:function(e,t,a){a.d(t,{A:function(){return y}});var l=a(6768),s=a(4232);const r={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},d={class:"modal-dialog",role:"document"},i={class:"modal-content border-0"},n={class:"modal-header bg-danger text-white"},o={class:"modal-title"},u=(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),p={class:"modal-body"},c={class:"text-danger"},k={class:"modal-footer"},h=(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function L(e,t,a,L,m,g){return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",d,[(0,l.Lk)("div",i,[(0,l.Lk)("div",n,[(0,l.Lk)("h5",o,[(0,l.Lk)("span",null,"刪除 "+(0,s.v_)(a.item.title),1)]),u]),(0,l.Lk)("div",p,[(0,l.eW)(" 是否刪除 "),(0,l.Lk)("strong",c,(0,s.v_)(a.item.title),1),(0,l.eW)(" (刪除後將無法恢復)。 ")]),(0,l.Lk)("div",k,[h,(0,l.Lk)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item"))},"確認刪除")])])])],512)}var m=a(3286),g={props:{item:{}},data(){return{modal:{}}},mixins:[m.A]},b=a(1241);const v=(0,b.A)(g,[["render",L]]);var y=v},2100:function(e,t,a){a.r(t),a.d(t,{default:function(){return ue}});var l=a(6768),s=a(4232),r=a(5130);const d=(0,l.Lk)("div",{class:"text mt-3"},[(0,l.Lk)("h4",null,"訂單列表")],-1),i=(0,l.Lk)("hr",null,null,-1),n={class:"text-end pt-1"},o={class:"table mt-4"},u=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"購買時間"),(0,l.Lk)("th",null,"Email"),(0,l.Lk)("th",null,"購買款項"),(0,l.Lk)("th",null,"應付金額"),(0,l.Lk)("th",null,"是否付款"),(0,l.Lk)("th",null,"編輯")])],-1),p={key:0},c={class:"list-unstyled"},k={class:"text-right"},h={class:"form-check form-switch"},L=["for"],m=["id","onUpdate:modelValue","onChange"],g={key:0},b={key:1},v={class:"btn-group"},y=["onClick"],O=["onClick"];function _(e,t,a,_,f,C){const x=(0,l.g2)("isLoading"),M=(0,l.g2)("BackOrderModal"),$=(0,l.g2)("DelModal"),E=(0,l.g2)("Pagination");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(x,{active:f.isLoading},null,8,["active"]),d,i,(0,l.Lk)("div",n,[f.orders.length?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=e=>C.openDelOrderModal(!0))}," 刪除全部訂單 ")):(0,l.Q3)("",!0)]),(0,l.Lk)("table",o,[u,(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(f.orders,((t,a)=>((0,l.uX)(),(0,l.CE)("tr",{key:a},[(0,l.Lk)("td",null,(0,s.v_)(e.$filters.date(t.create_at)),1),(0,l.Lk)("td",null,[t.user?((0,l.uX)(),(0,l.CE)("span",p,(0,s.v_)(t.user.email),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("td",null,[(0,l.Lk)("ul",c,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.products,((e,t)=>((0,l.uX)(),(0,l.CE)("li",{key:t},(0,s.v_)(e.product_id)+" 數量: "+(0,s.v_)(e.qty)+" "+(0,s.v_)(e.product.unit),1)))),128))])]),(0,l.Lk)("td",k,(0,s.v_)(e.$filters.currency(t.total)),1),(0,l.Lk)("td",null,[(0,l.Lk)("div",h,[(0,l.Lk)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[(0,l.bo)((0,l.Lk)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>C.updatePaid(t)},null,40,m),[[r.lH,t.is_paid]]),t.is_paid?((0,l.uX)(),(0,l.CE)("span",g,"已付款")):((0,l.uX)(),(0,l.CE)("span",b,"未付款"))],8,L)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",v,[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>C.openModal(t)}," 檢視 ",8,y),(0,l.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>C.openDelOrderModal(!1,t)}," 刪除 ",8,O)])])])))),128))])]),(0,l.bF)(M,{ref:"backOrderModal",order:f.tempOrder,onDelOrder:C.openDelOrderModal},null,8,["order","onDelOrder"]),(0,l.bF)($,{ref:"delModal",item:f.tempOrder,onDelItem:C.delOrder},null,8,["item","onDelItem"]),(0,l.bF)(E,{pages:f.pagination,onEmitPages:C.getOrders},null,8,["pages","onEmitPages"])],64)}const f={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog modal-xl",role:"document"},x={class:"modal-content border-0"},M=(0,l.Lk)("div",{class:"modal-header bg-warning text-white"},[(0,l.Lk)("h5",{class:"modal-title ms-2",id:"exampleModalLabel"},"訂單細節"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},E={class:"row"},P={class:"col col-xl-4"},X=(0,l.Lk)("h3",null,"用戶資料",-1),w={class:"table"},A={key:0},D=(0,l.Lk)("th",{style:{width:"100px"}},"姓名",-1),F=(0,l.Lk)("th",null,"Email",-1),I=["href"],S=(0,l.Lk)("th",null,"電話",-1),K=["href"],Q=(0,l.Lk)("th",null,"地址",-1),j={class:"col col-xl-8"},q=(0,l.Lk)("h3",null,"訂單細節",-1),B={class:"table"},U=(0,l.Lk)("th",{style:{width:"100px"}},"訂單編號",-1),V=(0,l.Lk)("th",null,"下單時間",-1),W=(0,l.Lk)("th",null,"付款時間",-1),H={key:0},N={key:1},z=(0,l.Lk)("th",null,"付款狀態",-1),G={key:0,class:"text-success"},J={key:1,class:"text-muted"},R=(0,l.Lk)("th",null,"總金額",-1),T=(0,l.Lk)("h3",null,"選購商品",-1),Y={class:"table"},Z={class:"text-end"};function ee(e,t,a,r,d,i){return(0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("div",C,[(0,l.Lk)("div",x,[M,(0,l.Lk)("div",$,[(0,l.Lk)("div",E,[(0,l.Lk)("div",P,[X,(0,l.Lk)("table",w,[d.tempOrder.user?((0,l.uX)(),(0,l.CE)("tbody",A,[(0,l.Lk)("tr",null,[D,(0,l.Lk)("td",null,(0,s.v_)(d.tempOrder.user.name),1)]),(0,l.Lk)("tr",null,[F,(0,l.Lk)("td",null,[(0,l.Lk)("a",{class:"text-decoration-none",href:`mailto:${d.tempOrder.user.email}`,style:{color:"#000000"}},(0,s.v_)(d.tempOrder.user.email),9,I)])]),(0,l.Lk)("tr",null,[S,(0,l.Lk)("td",null,[(0,l.Lk)("a",{class:"text-decoration-none",href:`tel:${d.tempOrder.user.tel}`,style:{color:"#000000"}},(0,s.v_)(d.tempOrder.user.tel),9,K)])]),(0,l.Lk)("tr",null,[Q,(0,l.Lk)("td",null,(0,s.v_)(d.tempOrder.user.address),1)])])):(0,l.Q3)("",!0)])]),(0,l.Lk)("div",j,[q,(0,l.Lk)("table",B,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[U,(0,l.Lk)("td",null,(0,s.v_)(d.tempOrder.id),1)]),(0,l.Lk)("tr",null,[V,(0,l.Lk)("td",null,(0,s.v_)(e.$filters.date(d.tempOrder.create_at)),1)]),(0,l.Lk)("tr",null,[W,(0,l.Lk)("td",null,[d.tempOrder.paid_date?((0,l.uX)(),(0,l.CE)("span",H,(0,s.v_)(e.$filters.date(d.tempOrder.paid_date)),1)):((0,l.uX)(),(0,l.CE)("span",N,"時間不正確"))])]),(0,l.Lk)("tr",null,[z,(0,l.Lk)("td",null,[d.tempOrder.is_paid?((0,l.uX)(),(0,l.CE)("strong",G,"已付款")):((0,l.uX)(),(0,l.CE)("span",J,"尚未付款"))])]),(0,l.Lk)("tr",null,[R,(0,l.Lk)("td",null,(0,s.v_)(e.$filters.currency(d.tempOrder.total)),1)])])]),T,(0,l.Lk)("table",Y,[(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.tempOrder.products,(t=>((0,l.uX)(),(0,l.CE)("tr",{key:t.id},[(0,l.Lk)("th",null,(0,s.v_)(t.product.title),1),(0,l.Lk)("td",null,(0,s.v_)(t.qty)+" / "+(0,s.v_)(t.product.unit),1),(0,l.Lk)("td",Z,(0,s.v_)(e.$filters.currency(t.final_total)),1)])))),128))])])])])])])])],512)}var te=a(3286),ae={props:{order:{type:Object,default(){return{}}}},watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.isPaid}},data(){return{modal:{},tempOrder:{},isPaid:!1}},mixins:[te.A]},le=a(1241);const se=(0,le.A)(ae,[["render",ee]]);var re=se,de=a(4652),ie=a(6778),ne={components:{BackOrderModal:re,DelModal:de.A,Pagination:ie.A},data(){return{isLoading:!1,orders:{},tempOrder:{},pagination:{},currentPage:1,isAllOrder:!0}},methods:{getOrders(e=1){const t=`https://vue3-course-api.hexschool.io/api/kstyle-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{this.$httpMessageState(e,"連線錯誤，請再試一次"),this.isLoading=!1}))},openModal(e){this.tempOrder={...e},this.$refs.backOrderModal.showModal(),this.isAllOrder=!1},updatePaid(e){const t=`https://vue3-course-api.hexschool.io/api/kstyle-api/admin/order/${e.id}`,a={is_paid:e.is_paid};this.isLoading=!0,this.$http.put(t,{data:a}).then((e=>{this.getOrders(this.currentPage),this.isLoading=!1,this.$httpMessageState(e,"更新付款狀態")})).catch((e=>{this.$httpMessageState(e,"連線錯誤，請再試一次"),this.isLoading=!1}))},openDelOrderModal(e,t){e?this.tempOrder={}:(this.tempOrder={...t},this.isAllOrder=!1),this.$refs.delModal.showModal(),this.$refs.backOrderModal.hideModal()},delOrder(){let e=`https://vue3-course-api.hexschool.io/api/kstyle-api/admin/order/${this.tempOrder.id}`;this.isAllOrder&&(e="https://vue3-course-api.hexschool.io/api/kstyle-api/admin/orders/all"),this.isLoading=!0,this.$http.delete(e).then((e=>{this.$refs.delModal.hideModal(),this.getOrders(this.currentPage),this.isLoading=!1,this.$httpMessageState(e,"刪除表單")})).catch((e=>{this.$httpMessageState(e,"連線錯誤，請再試一次"),this.isLoading=!1}))}},created(){this.getOrders()}};const oe=(0,le.A)(ne,[["render",_]]);var ue=oe}}]);
//# sourceMappingURL=100.684e4b23.js.map